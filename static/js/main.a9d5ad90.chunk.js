(this["webpackJsonpgaol-plugin"]=this["webpackJsonpgaol-plugin"]||[]).push([[0],{138:function(e,t,n){},163:function(e,t){},165:function(e,t){},181:function(e,t,n){},182:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),o=n.n(c),i=n(114),l=n(233),s=n(234),u=n(29),d=n(113),p=n(13),f=n(223),j=n(106),b=n.n(j),x=n(118),h=n(34),m=n(220),v=n(15),y=n(101),O=n(11),g=n(17),w=n.n(g),k=n(26),N=function(){var e=Object(k.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=C("say","text",t),e.next=4,window.callOverlayHandler(n);case 4:return e.abrupt("return",!0);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t,n){var a;return a={call:e},Object(O.a)(a,t,n),Object(O.a)(a,"key",t),Object(O.a)(a,"data",n),a},P={gaolRegex:/\|(.*)?\|2B6(B|C)\|.*?\|.*?\|/,nameRegex:/2B6(B|C)\|.*?\|.*?\|[A-Za-z ]+/,testRegex:/(.*)?(#-135-).*?/,testNameRegex:/#-135-[A-Za-z ]+/},S=P.gaolRegex,R=P.testRegex,T=P.nameRegex,z=P.testNameRegex,B=function(e,t){var n=e.findIndex((function(e){return t.includes(e)}));return[n,n>-1]},I=function(e,t){return e-t},D=function(e){var t=e.match(T),n=e.match(z);return t?t[0].split("|").pop():n?n[0].split("-").pop():null},E=n(18),A=n(20),G=n(60),M=n(105).createInstance({name:"gaoloverlay"});function L(e){var t=e.players,n=e.myNumber;return new Promise(function(){var e=Object(k.a)(w.a.mark((function e(a,r){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.setItem("gaol",{players:t,myNumber:n});case 3:return e.t0=console,e.next=6,M.getItem("gaol");case 6:e.t1=e.sent,e.t0.log.call(e.t0,e.t1),a(!0),e.next=14;break;case 11:e.prev=11,e.t2=e.catch(0),r(e.t2);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}())}var F=Object(G.b)("gaol/fetchUserConfig",Object(k.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(k.a)(w.a.mark((function e(t,n){var a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.getItem("gaol");case 3:a=e.sent,t(a||{}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))),U=Object(G.c)({name:"gaol",initialState:{number:-1,players:[],gaoledPlayers:[],myNumber:-1,nog:3,status:"ready",error:""},reducers:{order:function(e,t){e.number=t.payload},form:function(e,t){e.players=t.payload},position:function(e,t){e.myNumber=t.payload},error:function(e,t){e.error=t.payload},appendGaoledPlayer:function(e,t){e.gaoledPlayers=[].concat(Object(A.a)(e.gaoledPlayers),[t.payload])},resetGaoledPlayer:function(e){e.gaoledPlayers=[]}},extraReducers:function(e){e.addCase(F.pending,(function(e){e.status="loading"})).addCase(F.fulfilled,(function(e,t){e.status="ready",e.players=t.payload.players||e.players,e.myNumber=void 0!==t.payload.myNumber?t.payload.myNumber:e.myNumber}))}}),H=U.actions,J=H.order,Z=H.form,_=H.position,q=H.error,W=H.appendGaoledPlayer,X=H.resetGaoledPlayer,Y=function(e){return e.gaol.number},K=function(e){return e.gaol.myNumber},Q=function(e){return e.gaol.players},V=function(e){return e.gaol.gaoledPlayers},$=function(e){return e.gaol.error},ee=function(){return function(e,t){var n=V(t());if(3===n.length){var a=function(e,t){var n,a=t.map((function(e){return e}));return a.sort(I),[n=a.findIndex((function(t){return t===e}))+1,n>-1]}(K(t()),n),r=Object(E.a)(a,1)[0];console.log(n,r),N(r||"Eating Titan's ass."),setTimeout((function(){e(X()),e(J(-1))}),1e4),e(J(r))}}},te=function(e){var t=e.players,n=e.myNumber;return function(){var e=Object(k.a)(w.a.mark((function e(a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L({players:t,myNumber:n});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ne=U.reducer,ae=(n(138),n(5)),re=Object(m.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",padding:"5px 8px",background:Object(v.a)("#000000",.5)},msgRoot:{display:"flex",flexDirection:"column",justifyContent:"center"},msg:{fontSize:"9px"},order:{color:e.palette.success.main},timer:{fontSize:"10px"},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));var ce=function(){var e=Object(u.c)(Y),t=Object(u.c)($),n=re(),r=Object(u.b)();Object(a.useEffect)((function(){r(F());var e=[{name:"LogLine",event:c}];return function(e){try{e.forEach((function(e){window.addOverlayListener(e.name,(function(t){return e.event(t)}))})),window.startOverlayEvents(),console.log("Started Overlay plugin")}catch(t){console.error("Must import Overlay Plugin CDN"),console.error(t)}}(e),function(){return function(e){try{e.forEach((function(e){window.removeOverlayListener(e.name,(function(t){return e.event(t)}))})),console.log("Stopped Overlay plugin")}catch(t){console.error("Must import Overlay Plugin CDN"),console.error(t)}}(e)}}),[]);var c=Object(a.useCallback)((function(e){var t,n=e.rawLine;(t=n,S.test(t)||R.test(t))&&r(F()).then((function(){r(function(e){return function(t,n){var a=D,r=B(Q(n()),e),c=Object(E.a)(r,2),o=c[0];if(c[1])-1!==V(n()).find((function(e){return e===o}))&&(t(W(o)),t(ee()));else{t(X());var i=a(e);i&&(t(q("".concat(i," isn't in the party."))),setTimeout((function(){return t(q(""))}),3e3))}}}(n))}))}),[]);return Object(ae.jsxs)(x.a,{className:n.root,variant:"outlined",elevation:3,children:[Object(ae.jsxs)("div",{className:n.msgRoot,children:[Object(ae.jsxs)(h.a,{variant:"p",children:["Gaol:",Object(ae.jsx)("span",{children:" "}),Object(ae.jsx)(h.a,{variant:"subtitle1",className:n.order,display:"inline",children:e>-1?e||"Eating Titan's ass.":"N/A"}),Object(ae.jsx)("span",{children:" "}),e>-1&&Object(ae.jsx)(y.a,{date:Date.now()+1e4,intervalDelay:0,precision:2,renderer:function(e){return Object(ae.jsx)(h.a,{variant:"subtitle1",className:n.timer,display:"inline",children:"".concat(e.seconds,".").concat(e.milliseconds)})}})]}),Object(ae.jsx)(h.a,{variant:"body2",className:n.msg,color:"error",children:t||""})]}),Object(ae.jsx)("div",{children:Object(ae.jsx)(f.a,{"aria-label":"setting",size:"small",onClick:function(){return function(){var e=String(window.location.search),t=-1!==e.indexOf("?")?"&":"?";e="".concat(e).concat(t);var n=window.location.href;window.open("".concat(n,"settings"),"","width=630,height=870,location=no,menubar=yes")}()},children:Object(ae.jsx)(b.a,{})})})]})},oe=n(41),ie=n(2),le=n(40),se=n(107),ue=n.n(se),de=n(231),pe=n(237),fe=n(232),je=n(236),be=n(224),xe=n(225),he=n(228),me=n(112),ve=n.n(me),ye=n(109),Oe=n.n(ye),ge=n(111),we=n.n(ge),ke=n(110),Ne=n.n(ke),Ce=n(229),Pe=n(115),Se=n(240),Re=n(226),Te=n(227),ze=n(81),Be=function(e){var t={declaration:{attributes:{version:"1.0",encoding:"utf-8",standalone:"yes"}},elements:[]},n=e.map((function(e){return{type:"element",name:"Player",elements:[{type:"text",text:e}]}}));return t.elements.push({type:"element",name:"Priority",elements:n}),t},Ie=n(235),De=n(238),Ee=n(108),Ae=n.n(Ee),Ge=Object(m.a)((function(e){return{characterRow:{display:"flex",justifyContent:"space-between",padding:"7px 6px"},no:{marginRight:"6px"}}}));var Me=function(e){var t=e.name,n=void 0===t?"":t,a=e.selectMe,r=e.index,c=e.onChangeSelectMe,o=e.onTextInput,i=e.removeHandle,l=e.hiddenAction,s=Ge();return Object(ae.jsxs)("div",{className:s.characterRow,children:[Object(ae.jsxs)("div",{children:[Object(ae.jsx)(h.a,{className:s.no,variant:"body2",component:"span",children:r+1}),Object(ae.jsx)(De.a,{size:"small",checked:a===r,value:r,onChange:function(){return c(r)}}),Object(ae.jsx)(Ie.a,{id:"filled-search",label:"Character Name",value:n,type:"text",variant:"outlined",size:"small",onChange:function(e){return o(e.target.value,r)}})]}),!l&&Object(ae.jsx)(f.a,{"aria-label":"remove",color:"secondary",size:"small",onClick:function(){return i(r)},children:Object(ae.jsx)(Ae.a,{})})]})},Le={max:{fullParty:8,lightParty:4}},Fe=Object(m.a)((function(e){return{actionDiv:{display:"flex",justifyContent:"flex-end",marginTop:10},cancelBtn:{margin:"0px 10px"},dnone:{display:"none"}}}));var Ue=function(){var e=r.a.useState(!1),t=Object(E.a)(e,2),n=t[0],a=t[1],c=r.a.useState(null),o=Object(E.a)(c,2),i=o[0],l=o[1],s=r.a.useRef(null),d=r.a.useRef(null),p=Object(u.c)(K),j=Object(u.c)(Q),b=Object(u.b)();r.a.useEffect((function(){b(F())}),[n]);var x=function(){l(null)},h=function(e){x(),b(Z(j.filter((function(t,n){return n!==e}))))},m=function(){var e=Object(k.a)(w.a.mark((function e(){var t,n,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{x(),t=Be({}.players),n=ze.js2xml(t),a=new Blob([n],{type:"text/xml"}),function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsDataURL(e)}(a,(function(e){d.current.href=e,d.current.innerText=e,d.current.download="Priority.xml",d.current.click()}))}catch(r){console.error(r)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(e,t){var n=j.map((function(n,a){return a===t?e:n}));b(Z(n))},y=function(e){b(_(e))},O=function(){var e=Object(k.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(te({players:j,myNumber:p})),alert("Saved successful.");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Le.max.fullParty;return j.length===e?"Full Party":"Light Party"}(),N=Fe(),C=[{title:"New",icon:Object(ae.jsx)(Oe.a,{fontSize:"small"}),action:function(){x(),j.length<Le.max.fullParty&&b(Z([].concat(Object(A.a)(j),[""])))},disabled:j.length>=Le.max.fullParty},{title:"Import",icon:Object(ae.jsx)(Ne.a,{fontSize:"small"}),action:function(){s.current.click()}},{title:"Export",icon:Object(ae.jsx)(we.a,{fontSize:"small"}),action:m,disabled:!0,display:!0}];return Object(ae.jsxs)("div",{children:[Object(ae.jsxs)(be.a,{style:{paddingBottom:0},children:[Object(ae.jsx)(xe.a,{action:Object(ae.jsx)(f.a,{onClick:function(e){l(e.currentTarget)},"aria-controls":"simple-menu","aria-haspopup":"true","aria-label":"more",children:Object(ae.jsx)(ve.a,{})}),title:"".concat(g),titleTypographyProps:{variant:"h6"},subheader:"The ones who are suffering in UwU."}),Object(ae.jsx)(Pe.a,{id:"simple-menu",anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:x,children:C.map((function(e,t){return void 0===e.display||e.display?Object(ae.jsxs)(Se.a,{onClick:e.action,disabled:void 0!==e.disabled&&e.disabled,children:[Object(ae.jsx)(Re.a,{children:e.icon}),Object(ae.jsx)(Te.a,{primary:e.title})]},t):""}))}),Object(ae.jsx)(he.a,{children:j.map((function(e,t){return Object(ae.jsx)(Me,{selectMe:p,index:t,name:e,onChangeSelectMe:y,onTextInput:v,removeHandle:h,hiddenAction:j.length<=1},t)}))})]}),Object(ae.jsxs)("div",{className:N.actionDiv,children:[Object(ae.jsx)(Ce.a,{variant:"contained",color:"secondary",className:N.cancelBtn,onClick:function(){a((function(e){return!e}))},children:"Reset"}),Object(ae.jsx)(Ce.a,{variant:"contained",color:"primary",onClick:O,children:"Save"})]}),Object(ae.jsx)("input",{type:"file",id:"import",ref:s,className:N.dnone,onChange:function(e){e.stopPropagation(),e.preventDefault(),x();var t=e.target.files[0],n=new FileReader;n.onload=function(e){try{var t=e.target.result,n=ze.xml2js(t);if(!n)throw"The reault of file's content is invalid, result: ".concat(n);var a=n.elements[0].elements.map((function(e){return e.elements[0].text}));b(Z(a))}catch(r){alert("Cannot import XML file, please try again."),console.error(r)}},n.readAsText(t)},onClick:function(e){return e.target.value=null}})]})},He=n(230);var Je=function(){var e=Object(le.a)();console.log(e);var t=Object(m.a)((function(e){return{spaceTop:{marginTop:"30px"}}}))();return Object(ae.jsx)("div",{children:Object(ae.jsx)(be.a,{style:{paddingBottom:0},children:Object(ae.jsxs)(he.a,{children:[Object(ae.jsx)(h.a,{variant:"h6",color:"textSecondary",children:"Gaol Overlay"}),Object(ae.jsxs)(h.a,{variant:"subtitle2",color:"textSecondary",children:["Developed by ",Object(ae.jsx)(He.a,{color:"primary",underline:"none",href:"https://na.finalfantasyxiv.com/lodestone/character/31961672/",target:"_blank",children:"Supskv"}),"."]}),Object(ae.jsx)(h.a,{variant:"h6",color:"textSecondary",className:t.spaceTop,children:"Github"}),Object(ae.jsx)(h.a,{variant:"subtitle2",color:"textSecondary",children:"See the latest code, changelog, and readme on Github. You can also submit bug reports or feature requests."}),Object(ae.jsx)(He.a,{underline:"none",href:"https://github.com/supskv/gaol-plugin",target:"_blank",children:"https://github.com/supskv/gaol-plugin"}),Object(ae.jsx)(h.a,{variant:"subtitle2",color:"textSecondary",className:t.spaceTop,children:"version 0.1.10-alpha"})]})})})},Ze=["children","value","index"];function _e(e){var t=e.children,n=e.value,a=e.index,r=Object(ie.a)(e,Ze);return Object(ae.jsx)("div",Object(oe.a)(Object(oe.a)({role:"tabpanel",hidden:n!==a,id:"full-width-tabpanel-".concat(a),"aria-labelledby":"full-width-tab-".concat(a)},r),{},{children:n===a&&Object(ae.jsx)(je.a,{p:3,children:Object(ae.jsx)(h.a,{children:t})})}))}function qe(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}var We=function(){var e=Object(le.a)(),t=Object(m.a)((function(e){return{root:{background:e.palette.background.default,height:"inherit"}}}))(),n=r.a.useState(0),a=Object(E.a)(n,2),c=a[0],o=a[1];return Object(ae.jsxs)("div",{className:t.root,children:[Object(ae.jsx)(de.a,{position:"sticky",color:"default",children:Object(ae.jsxs)(pe.a,{value:c,onChange:function(e,t){o(t)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example",children:[Object(ae.jsx)(fe.a,Object(oe.a)({label:"General"},qe(0))),Object(ae.jsx)(fe.a,Object(oe.a)({label:"About"},qe(1)))]})}),Object(ae.jsxs)(ue.a,{index:c,onChangeIndex:function(e){o(e)},children:[Object(ae.jsx)(_e,{value:c,index:0,dir:e.direction,children:Object(ae.jsx)(Ue,{})}),Object(ae.jsx)(_e,{value:c,index:1,dir:e.direction,children:Object(ae.jsx)(Je,{})})]})]})};var Xe=function(){return Object(ae.jsx)(ae.Fragment,{children:Object(ae.jsx)(d.a,{children:Object(ae.jsxs)(p.c,{children:[Object(ae.jsx)(p.a,{exact:!0,path:"/",children:Object(ae.jsx)(ce,{})}),Object(ae.jsx)(p.a,{path:"/settings",children:Object(ae.jsx)(We,{})})]})})})},Ye=Object(G.a)({reducer:{gaol:ne}}),Ke=(n(181),Object(i.a)({palette:{type:"dark"}}));o.a.render(Object(ae.jsx)(r.a.StrictMode,{children:Object(ae.jsxs)(l.a,{theme:Ke,children:[Object(ae.jsx)(s.a,{}),Object(ae.jsx)(u.a,{store:Ye,children:Object(ae.jsx)(Xe,{})})]})}),document.getElementById("root"))}},[[182,1,2]]]);
//# sourceMappingURL=main.a9d5ad90.chunk.js.map