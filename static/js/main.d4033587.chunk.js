(this["webpackJsonpgaol-plugin"]=this["webpackJsonpgaol-plugin"]||[]).push([[0],{138:function(e,t,n){},163:function(e,t){},165:function(e,t){},181:function(e,t,n){},182:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),o=n.n(c),i=n(114),l=n(233),s=n(234),u=n(28),d=n(113),j=n(13),p=n(223),f=n(106),b=n.n(f),x=n(118),m=n(34),h=n(220),v=n(15),y=n(101),O={gaolRegex:/\|(.*)?\|2B6(B|C)\|.*?\|.*?\|/,nameRegex:/2B6(B|C)\|.*?\|.*?\|[A-Za-z ]+/,testRegex:/(.*)?(#-135-).*?/,testNameRegex:/#-135-[A-Za-z ]+/},g=O.gaolRegex,w=O.testRegex,N=O.nameRegex,k=O.testNameRegex,C=function(e,t){var n=e.findIndex((function(e){return t.includes(e)}));return[n,n>-1]},P=function(e,t){return e-t},S=function(e){var t=e.match(N),n=e.match(k);return t?t[0].split("|").pop():n?n[0].split("-").pop():null},R=n(17),T=n(20),z=n(19),B=n.n(z),I=n(33),D=n(60),A=n(105).createInstance({name:"gaoloverlay"});function E(e){var t=e.players,n=e.myNumber;return new Promise(function(){var e=Object(I.a)(B.a.mark((function e(a,r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.setItem("gaol",{players:t,myNumber:n});case 3:return e.t0=console,e.next=6,A.getItem("gaol");case 6:e.t1=e.sent,e.t0.log.call(e.t0,e.t1),a(!0),e.next=14;break;case 11:e.prev=11,e.t2=e.catch(0),r(e.t2);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}())}var G=Object(D.b)("gaol/fetchUserConfig",Object(I.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(I.a)(B.a.mark((function e(t,n){var a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.getItem("gaol");case 3:a=e.sent,t(a||{}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))),M=Object(D.c)({name:"gaol",initialState:{number:-1,players:[],gaoledPlayers:[],myNumber:-1,nog:3,status:"ready",error:""},reducers:{order:function(e,t){e.number=t.payload},form:function(e,t){e.players=t.payload},position:function(e,t){e.myNumber=t.payload},error:function(e,t){e.error=t.payload},appendGaoledPlayer:function(e,t){e.gaoledPlayers=[].concat(Object(T.a)(e.gaoledPlayers),[t.payload])},resetGaoledPlayer:function(e){e.gaoledPlayers=[]}},extraReducers:function(e){e.addCase(G.pending,(function(e){e.status="loading"})).addCase(G.fulfilled,(function(e,t){e.status="ready",e.players=t.payload.players||e.players,e.myNumber=void 0!==t.payload.myNumber?t.payload.myNumber:e.myNumber}))}}),L=M.actions,F=L.order,U=L.form,H=L.position,J=L.error,Z=L.appendGaoledPlayer,_=L.resetGaoledPlayer,q=function(e){return e.gaol.number},W=function(e){return e.gaol.myNumber},X=function(e){return e.gaol.players},Y=function(e){return e.gaol.gaoledPlayers},K=function(e){return e.gaol.error},Q=function(){return function(e,t){var n=Y(t());if(3===n.length){var a=function(e,t){var n,a=t.map((function(e){return e}));return a.sort(P),[n=a.findIndex((function(t){return t===e}))+1,n>-1]}(W(t()),n),r=Object(R.a)(a,1)[0];console.log(n,r),setTimeout((function(){e(_()),e(F(-1))}),1e4),e(F(r))}}},V=function(e){var t=e.players,n=e.myNumber;return function(){var e=Object(I.a)(B.a.mark((function e(a){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({players:t,myNumber:n});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},$=M.reducer,ee=(n(138),n(5)),te=Object(h.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",padding:"5px 8px",background:Object(v.a)("#000000",.5)},msgRoot:{display:"flex",flexDirection:"column",justifyContent:"center"},msg:{fontSize:"9px"},order:{color:e.palette.success.main},timer:{fontSize:"10px"},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));var ne=function(){var e=Object(u.c)(q),t=Object(u.c)(K),n=te(),r=Object(u.b)();Object(a.useEffect)((function(){r(G());var e=[{name:"LogLine",event:c}];return function(e){try{e.forEach((function(e){window.addOverlayListener(e.name,(function(t){return e.event(t)}))})),window.startOverlayEvents(),console.log("Started Overlay plugin")}catch(t){console.error("Must import Overlay Plugin CDN"),console.error(t)}}(e),function(){return function(e){try{e.forEach((function(e){window.removeOverlayListener(e.name,(function(t){return e.event(t)}))})),console.log("Stopped Overlay plugin")}catch(t){console.error("Must import Overlay Plugin CDN"),console.error(t)}}(e)}}),[]);var c=Object(a.useCallback)((function(e){var t,n=e.rawLine;(t=n,g.test(t)||w.test(t))&&r(G()).then((function(){r(function(e){return function(t,n){var a=S,r=C(X(n()),e),c=Object(R.a)(r,2),o=c[0];if(c[1])-1!==Y(n()).find((function(e){return e===o}))&&(t(Z(o)),t(Q()));else{t(_());var i=a(e);i&&(t(J("".concat(i," isn't in the party."))),setTimeout((function(){return t(J(""))}),3e3))}}}(n))}))}),[]);return Object(ee.jsxs)(x.a,{className:n.root,variant:"outlined",elevation:3,children:[Object(ee.jsxs)("div",{className:n.msgRoot,children:[Object(ee.jsxs)(m.a,{variant:"p",children:["Gaol:",Object(ee.jsx)("span",{children:" "}),Object(ee.jsx)(m.a,{variant:"subtitle1",className:n.order,display:"inline",children:e>-1?e||"Eating Titan's ass.":"N/A"}),Object(ee.jsx)("span",{children:" "}),e>-1&&Object(ee.jsx)(y.a,{date:Date.now()+1e4,intervalDelay:0,precision:2,renderer:function(e){return Object(ee.jsx)(m.a,{variant:"subtitle1",className:n.timer,display:"inline",children:"".concat(e.seconds,".").concat(e.milliseconds)})}})]}),Object(ee.jsx)(m.a,{variant:"body2",className:n.msg,color:"error",children:t||""})]}),Object(ee.jsx)("div",{children:Object(ee.jsx)(p.a,{"aria-label":"setting",size:"small",onClick:function(){return function(){var e=String(window.location.search),t=-1!==e.indexOf("?")?"&":"?";e="".concat(e).concat(t);var n=window.location.href;window.open("".concat(n,"settings"),"","width=630,height=870,location=no,menubar=yes")}()},children:Object(ee.jsx)(b.a,{})})})]})},ae=n(41),re=n(2),ce=n(40),oe=n(107),ie=n.n(oe),le=n(231),se=n(237),ue=n(232),de=n(236),je=n(224),pe=n(225),fe=n(228),be=n(112),xe=n.n(be),me=n(109),he=n.n(me),ve=n(111),ye=n.n(ve),Oe=n(110),ge=n.n(Oe),we=n(229),Ne=n(115),ke=n(240),Ce=n(226),Pe=n(227),Se=n(81),Re=function(e){var t={declaration:{attributes:{version:"1.0",encoding:"utf-8",standalone:"yes"}},elements:[]},n=e.map((function(e){return{type:"element",name:"Player",elements:[{type:"text",text:e}]}}));return t.elements.push({type:"element",name:"Priority",elements:n}),t},Te=n(235),ze=n(238),Be=n(108),Ie=n.n(Be),De=Object(h.a)((function(e){return{characterRow:{display:"flex",justifyContent:"space-between",padding:"7px 6px"},no:{marginRight:"6px"}}}));var Ae=function(e){var t=e.name,n=void 0===t?"":t,a=e.selectMe,r=e.index,c=e.onChangeSelectMe,o=e.onTextInput,i=e.removeHandle,l=e.hiddenAction,s=De();return Object(ee.jsxs)("div",{className:s.characterRow,children:[Object(ee.jsxs)("div",{children:[Object(ee.jsx)(m.a,{className:s.no,variant:"body2",component:"span",children:r+1}),Object(ee.jsx)(ze.a,{size:"small",checked:a===r,value:r,onChange:function(){return c(r)}}),Object(ee.jsx)(Te.a,{id:"filled-search",label:"Character Name",value:n,type:"text",variant:"outlined",size:"small",onChange:function(e){return o(e.target.value,r)}})]}),!l&&Object(ee.jsx)(p.a,{"aria-label":"remove",color:"secondary",size:"small",onClick:function(){return i(r)},children:Object(ee.jsx)(Ie.a,{})})]})},Ee={max:{fullParty:8,lightParty:4}},Ge=Object(h.a)((function(e){return{actionDiv:{display:"flex",justifyContent:"flex-end",marginTop:10},cancelBtn:{margin:"0px 10px"},dnone:{display:"none"}}}));var Me=function(){var e=r.a.useState(!1),t=Object(R.a)(e,2),n=t[0],a=t[1],c=r.a.useState(null),o=Object(R.a)(c,2),i=o[0],l=o[1],s=r.a.useRef(null),d=r.a.useRef(null),j=Object(u.c)(W),f=Object(u.c)(X),b=Object(u.b)();r.a.useEffect((function(){b(G())}),[n]);var x=function(){l(null)},m=function(e){x(),b(U(f.filter((function(t,n){return n!==e}))))},h=function(){var e=Object(I.a)(B.a.mark((function e(){var t,n,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{x(),t=Re({}.players),n=Se.js2xml(t),a=new Blob([n],{type:"text/xml"}),function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsDataURL(e)}(a,(function(e){d.current.href=e,d.current.innerText=e,d.current.download="Priority.xml",d.current.click()}))}catch(r){console.error(r)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(e,t){var n=f.map((function(n,a){return a===t?e:n}));b(U(n))},y=function(e){b(H(e))},O=function(){var e=Object(I.a)(B.a.mark((function e(){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(V({players:f,myNumber:j})),alert("Saved successful.");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Ee.max.fullParty;return f.length===e?"Full Party":"Light Party"}(),w=Ge(),N=[{title:"New",icon:Object(ee.jsx)(he.a,{fontSize:"small"}),action:function(){x(),f.length<Ee.max.fullParty&&b(U([].concat(Object(T.a)(f),[""])))},disabled:f.length>=Ee.max.fullParty},{title:"Import",icon:Object(ee.jsx)(ge.a,{fontSize:"small"}),action:function(){s.current.click()}},{title:"Export",icon:Object(ee.jsx)(ye.a,{fontSize:"small"}),action:h,disabled:!0,display:!0}];return Object(ee.jsxs)("div",{children:[Object(ee.jsxs)(je.a,{style:{paddingBottom:0},children:[Object(ee.jsx)(pe.a,{action:Object(ee.jsx)(p.a,{onClick:function(e){l(e.currentTarget)},"aria-controls":"simple-menu","aria-haspopup":"true","aria-label":"more",children:Object(ee.jsx)(xe.a,{})}),title:"".concat(g),titleTypographyProps:{variant:"h6"},subheader:"The ones who are suffering in UwU."}),Object(ee.jsx)(Ne.a,{id:"simple-menu",anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:x,children:N.map((function(e,t){return void 0===e.display||e.display?Object(ee.jsxs)(ke.a,{onClick:e.action,disabled:void 0!==e.disabled&&e.disabled,children:[Object(ee.jsx)(Ce.a,{children:e.icon}),Object(ee.jsx)(Pe.a,{primary:e.title})]},t):""}))}),Object(ee.jsx)(fe.a,{children:f.map((function(e,t){return Object(ee.jsx)(Ae,{selectMe:j,index:t,name:e,onChangeSelectMe:y,onTextInput:v,removeHandle:m,hiddenAction:f.length<=1},t)}))})]}),Object(ee.jsxs)("div",{className:w.actionDiv,children:[Object(ee.jsx)(we.a,{variant:"contained",color:"secondary",className:w.cancelBtn,onClick:function(){a((function(e){return!e}))},children:"Reset"}),Object(ee.jsx)(we.a,{variant:"contained",color:"primary",onClick:O,children:"Save"})]}),Object(ee.jsx)("input",{type:"file",id:"import",ref:s,className:w.dnone,onChange:function(e){e.stopPropagation(),e.preventDefault(),x();var t=e.target.files[0],n=new FileReader;n.onload=function(e){try{var t=e.target.result,n=Se.xml2js(t);if(!n)throw"The reault of file's content is invalid, result: ".concat(n);var a=n.elements[0].elements.map((function(e){return e.elements[0].text}));b(U(a))}catch(r){alert("Cannot import XML file, please try again."),console.error(r)}},n.readAsText(t)}})]})},Le=n(230);var Fe=function(){var e=Object(ce.a)();console.log(e);var t=Object(h.a)((function(e){return{spaceTop:{marginTop:"30px"}}}))();return Object(ee.jsx)("div",{children:Object(ee.jsx)(je.a,{style:{paddingBottom:0},children:Object(ee.jsxs)(fe.a,{children:[Object(ee.jsx)(m.a,{variant:"h6",color:"textSecondary",children:"Gaol Overlay"}),Object(ee.jsxs)(m.a,{variant:"subtitle2",color:"textSecondary",children:["Developed by ",Object(ee.jsx)(Le.a,{color:"primary",underline:"none",href:"https://na.finalfantasyxiv.com/lodestone/character/31961672/",target:"_blank",children:"Supskv"}),"."]}),Object(ee.jsx)(m.a,{variant:"h6",color:"textSecondary",className:t.spaceTop,children:"Github"}),Object(ee.jsx)(m.a,{variant:"subtitle2",color:"textSecondary",children:"See the latest code, changelog, and readme on Github. You can also submit bug reports or feature requests."}),Object(ee.jsx)(Le.a,{underline:"none",href:"https://github.com/supskv/gaol-plugin",target:"_blank",children:"https://github.com/supskv/gaol-plugin"}),Object(ee.jsx)(m.a,{variant:"subtitle2",color:"textSecondary",className:t.spaceTop,children:"version 0.1.10-alpha"})]})})})},Ue=["children","value","index"];function He(e){var t=e.children,n=e.value,a=e.index,r=Object(re.a)(e,Ue);return Object(ee.jsx)("div",Object(ae.a)(Object(ae.a)({role:"tabpanel",hidden:n!==a,id:"full-width-tabpanel-".concat(a),"aria-labelledby":"full-width-tab-".concat(a)},r),{},{children:n===a&&Object(ee.jsx)(de.a,{p:3,children:Object(ee.jsx)(m.a,{children:t})})}))}function Je(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}var Ze=function(){var e=Object(ce.a)(),t=Object(h.a)((function(e){return{root:{background:e.palette.background.default,height:"inherit"}}}))(),n=r.a.useState(0),a=Object(R.a)(n,2),c=a[0],o=a[1];return Object(ee.jsxs)("div",{className:t.root,children:[Object(ee.jsx)(le.a,{position:"sticky",color:"default",children:Object(ee.jsxs)(se.a,{value:c,onChange:function(e,t){o(t)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth","aria-label":"full width tabs example",children:[Object(ee.jsx)(ue.a,Object(ae.a)({label:"General"},Je(0))),Object(ee.jsx)(ue.a,Object(ae.a)({label:"About"},Je(1)))]})}),Object(ee.jsxs)(ie.a,{index:c,onChangeIndex:function(e){o(e)},children:[Object(ee.jsx)(He,{value:c,index:0,dir:e.direction,children:Object(ee.jsx)(Me,{})}),Object(ee.jsx)(He,{value:c,index:1,dir:e.direction,children:Object(ee.jsx)(Fe,{})})]})]})};var _e=function(){return Object(ee.jsx)(ee.Fragment,{children:Object(ee.jsx)(d.a,{children:Object(ee.jsxs)(j.c,{children:[Object(ee.jsx)(j.a,{exact:!0,path:"/",children:Object(ee.jsx)(ne,{})}),Object(ee.jsx)(j.a,{path:"/settings",children:Object(ee.jsx)(Ze,{})})]})})})},qe=Object(D.a)({reducer:{gaol:$}}),We=(n(181),Object(i.a)({palette:{type:"dark"}}));o.a.render(Object(ee.jsx)(r.a.StrictMode,{children:Object(ee.jsxs)(l.a,{theme:We,children:[Object(ee.jsx)(s.a,{}),Object(ee.jsx)(u.a,{store:qe,children:Object(ee.jsx)(_e,{})})]})}),document.getElementById("root"))}},[[182,1,2]]]);
//# sourceMappingURL=main.d4033587.chunk.js.map